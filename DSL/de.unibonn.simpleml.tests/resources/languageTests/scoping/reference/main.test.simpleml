package tests.languageTests.scoping.reference1

import tests.languageTests.scoping.reference2.AnnotationInOtherPackage1
import tests.languageTests.scoping.reference2.ClassInOtherPackage1
import tests.languageTests.scoping.reference2.EnumInOtherPackage1
import tests.languageTests.scoping.reference2.globalFunctionInOtherPackage1
import tests.languageTests.scoping.reference2.InterfaceInOtherPackage1
import tests.languageTests.scoping.reference2.stepInOtherPackage1
import tests.languageTests.scoping.reference2.workflowInOtherPackage1

annotation AnnotationInSameFile

open class SuperClass {
    static attr superClassStaticAttribute: Int
    attr superClassInstanceAttribute: Int

    class ClassInSuperClass

    enum EnumInSuperClass

    static fun superClassStaticMethod()
    fun superClassInstanceMethod()

    interface InterfaceInSuperClass
}
class ClassInSameFile<TYPE_PARAMETER_IN_SAME_FILE> constructor() sub SuperClass {
    static attr classStaticAttributeInSameFile: Int
    attr classInstanceAttributeInSameFile: Int

    class ClassInClassInSameFile

    enum EnumInClassInSameFile

    static fun classStaticMethodInSameFile() -> classStaticMethodResultInSameFile: Int
    fun classInstanceMethodInSameFile() -> classInstanceMethodResultInSameFile: Int

    interface InterfaceInClassInSameFile
}

enum EnumInSameFile {
    ENUM_INSTANCE_IN_SAME_FILE
}

fun globalFunctionInSameFile(globalFunctionParameterInSameFile: Int) -> globalFunctionResultInSameFile: Int

interface SuperInterface {
    static attr superInterfaceStaticAttribute: Int
    attr superInterfaceInstanceAttribute: Int

    class ClassInSuperInterface

    enum EnumInSuperInterface

    static fun superInterfaceStaticMethod()
    fun superInterfaceInstanceMethod()

    interface InterfaceInSuperInterface
}
interface InterfaceInSameFile sub SuperInterface {
    static attr interfaceStaticAttributeInSameFile: Int
    attr interfaceInstanceAttributeInSameFile: Int

    class ClassInInterfaceInSameFile

    enum EnumInInterfaceInSameFile

    static fun interfaceStaticMethodInSameFile() -> interfaceStaticMethodResultInSameFile: Int
    fun interfaceInstanceMethodInSameFile() -> interfaceInstanceMethodInSameFile: Int

    interface InterfaceInInterfaceInSameFile
}
fun interfaceInSameFileFactory() -> result: InterfaceInSameFile

step stepInSameFile(stepParameterInSameFile: Int) -> stepResultInSameFile: Int {
    val placeholderInSameFile = 1;
}

workflow workflowInSameFile {}


// Direct references -----------------------------------------------------------

step directReferencesToAnnotations() {
    AnnotationInSameFile;
    AnnotationInSamePackage;
    AnnotationInOtherPackage1;
    AnnotationInOtherPackage2;
}

step directReferencesToClasses() {
    ClassInSameFile;
    ClassInSamePackage;
    ClassInOtherPackage1;
    ClassInOtherPackage2;
}

step directReferencesToEnums() {
    EnumInSameFile;
    EnumInSamePackage;
    EnumInOtherPackage1;
    EnumInOtherPackage2;
}

step directReferencesToGlobalFunctions() {
    globalFunctionInSameFile;
    globalFunctionInSamePackage;
    globalFunctionInOtherPackage1;
    globalFunctionInOtherPackage2;
}

step directReferencesToInterfaces() {
    InterfaceInSameFile;
    InterfaceInSamePackage;
    InterfaceInOtherPackage1;
    InterfaceInOtherPackage2;
}

step directReferencesToLambdaYields() {
    val f = lambda {
        yield lambdaYield = 1;
        lambdaYield;
    };
}

step directReferencesToParameters(parameterInStep: Int) {
    parameterInStep;

    val f = lambda (parameterInLambda: Int) {
        parameterInStep;
        parameterInLambda;

        val f = lambda {
            parameterInStep;
            parameterInLambda;
        };
    };
}

step directReferencesToPlaceholders() {
    val placeholderInStep = 1;
    placeholderInStep;

    val f = lambda () {
        val placeholderInLambda = 1;
        placeholderInStep;
        placeholderInLambda;

        val f = lambda {
            placeholderInStep;
            placeholderInLambda;
        };
    };
}

step directReferencesToTypeParameters() {
    TYPE_PARAMETER_IN_SAME_FILE;
}

step directReferencesToWorkflowSteps() {
    stepInSameFile;
    stepInSamePackage;
    stepInOtherPackage1;
    stepInOtherPackage2;
}

step directReferencesToWorkflows() {
    workflowInSameFile;
    workflowInSamePackage;
    workflowInOtherPackage1;
    workflowInOtherPackage2;
}

step forwardReferences() {
    val a = b;
    val b = 1;

    val f = lambda {
        f;
    };
}

step shadowedReferences(ClassInSameFile: Int) {
    ClassInSameFile;

    val ClassInSameFile = 1;
    ClassInSameFile;

    val f = lambda {
        val ClassInSameFile = 1;
        ClassInSameFile;
    };
}

// Access to own members -------------------------------------------------------

step referencesToClassMembers() {
    ClassInSameFile.classStaticAttributeInSameFile;
    ClassInSameFile<*>().classInstanceAttributeInSameFile;
    ClassInSameFile.ClassInClassInSameFile;
    ClassInSameFile.EnumInClassInSameFile;
    ClassInSameFile.classStaticMethodInSameFile;
    ClassInSameFile<*>().classInstanceMethodInSameFile();
    ClassInSameFile.InterfaceInClassInSameFile;
}

step referencesToEnumInstances() {
    EnumInSameFile.ENUM_INSTANCE_IN_SAME_FILE;
}

step referencesToInterfaceMembers() {
    InterfaceInSameFile.interfaceStaticAttributeInSameFile;
    interfaceInSameFileFactory().interfaceInstanceAttributeInSameFile;
    InterfaceInSameFile.ClassInInterfaceInSameFile;
    InterfaceInSameFile.EnumInInterfaceInSameFile;
    InterfaceInSameFile.interfaceStaticMethodInSameFile;
    interfaceInSameFileFactory().interfaceInstanceMethodInSameFile();
    InterfaceInSameFile.InterfaceInInterfaceInSameFile;
}

// Access to inherited members -------------------------------------------------

step referencesToInheritedClassMembers() {
    ClassInSameFile.superClassStaticAttribute;
    ClassInSameFile<*>().superClassInstanceAttribute;
    ClassInSameFile.ClassInSuperClass;
    ClassInSameFile.EnumInSuperClass;
    ClassInSameFile.superClassStaticMethod;
    ClassInSameFile<*>().superClassInstanceMethod();
    ClassInSameFile.InterfaceInSuperClass;
}

step referencesToInheritedInterfaceMembers() {
    InterfaceInSameFile.superInterfaceStaticAttribute;
    interfaceInSameFileFactory().superInterfaceInstanceAttribute;
    InterfaceInSameFile.ClassInSuperInterface;
    InterfaceInSameFile.EnumInSuperInterface;
    InterfaceInSameFile.superInterfaceStaticMethod;
    interfaceInSameFileFactory().superInterfaceInstanceMethod();
    InterfaceInSameFile.InterfaceInSuperInterface;
}

// Access to static members from instance --------------------------------------

step referencesToStaticClassMembersFromInstance() {
    ClassInSameFile<*>().superClassStaticAttribute;
    ClassInSameFile<*>().ClassInSuperClass;
    ClassInSameFile<*>().EnumInSuperClass;
    ClassInSameFile<*>().superClassStaticMethod;
    ClassInSameFile<*>().InterfaceInSuperClass;
}

step referencesToStaticInterfaceMembersFromInstance() {
    interfaceInSameFileFactory().superInterfaceStaticAttribute;
    interfaceInSameFileFactory().ClassInSuperInterface;
    interfaceInSameFileFactory().EnumInSuperInterface;
    interfaceInSameFileFactory().superInterfaceStaticMethod;
    interfaceInSameFileFactory().InterfaceInSuperInterface;
}

// Access to instance members from class/interface -----------------------------

step referencesToInheritedClassMembers() {
    ClassInSameFile.superClassStaticAttribute;
    ClassInSameFile<*>().superClassInstanceAttribute;
    ClassInSameFile.ClassInSuperClass;
    ClassInSameFile.EnumInSuperClass;
    ClassInSameFile.superClassStaticMethod;
    ClassInSameFile<*>().superClassInstanceMethod();
    ClassInSameFile.InterfaceInSuperClass;
}

step referencesToInheritedInterfaceMembers() {
    InterfaceInSameFile.superInterfaceStaticAttribute;
    interfaceInSameFileFactory().superInterfaceInstanceAttribute;
    InterfaceInSameFile.ClassInSuperInterface;
    InterfaceInSameFile.EnumInSuperInterface;
    InterfaceInSameFile.superInterfaceStaticMethod;
    interfaceInSameFileFactory().superInterfaceInstanceMethod();
    InterfaceInSameFile.InterfaceInSuperInterface;
}

// Access to results of callable -----------------------------------------------

step referencesToCallableTypeResults(f: callable () -> (callableTypeResult: Int)) {
    f().callableTypeResult;
}

step referencesToFunctionResults() {
    ClassInSameFile.classStaticMethodInSameFile(1).classStaticMethodResultInSameFile;
    ClassInSameFile<*>(1).classInstanceMethodInSameFile(1).classInstanceMethodResultInSameFile;

    globalFunctionInSameFile(1).globalFunctionResultInSameFile;

    InterfaceInSameFile.interfaceStaticMethodInSameFile().interfaceStaticMethodResultInSameFile;
    interfaceInSameFileFactory().interfaceInstanceMethodInSameFile().interfaceInstanceMethodResultInSameFile;
}

step referencesToLambdaResults() {
    val f = lambda {
        yield lambdaResult = 1;
    };
    
    f().lambdaResult;
}

step referencesToWorkflowStepResults() {
    stepInSameFile(1).stepResultInSameFile;
}

// Access to locals from outside -----------------------------------------------

step referencesToGlobalFunctionLocals() {
    globalFunctionParameterInSameFile;
    globalFunctionResultInSameFile;
}

step referencesToLambdaLocals() {
    val f = lambda (lambdaParameter: Int) {
        val lambdaPlaceholder = 1;
        yield lambdaYield = 1;
    };

    lambdaParameter;
    lambdaPlaceholder;
    lambdaYield;
}

step referencesToWorkflowStepLocals() {
    stepParameterInSameFile;
    stepResultInSameFile;
    placeholderInSameFile;
}

// Unqualified access to members -----------------------------------------------

step unqualifiedReferencesToClassMembers() {
    classStaticAttributeInSameFile;
    classInstanceAttributeInSameFile;

    ClassInClassInSameFile;

    EnumInClassInSameFile;

    classStaticMethodInSameFile;
    classInstanceMethodInSameFile;

    InterfaceInClassInSameFile;
}

step unqualifiedReferencesToEnumInstances() {
    ENUM_INSTANCE_IN_SAME_FILE;
}

step unqualifiedReferencesToInterfaceMembers() {
    interfaceStaticAttributeInSameFile;
    interfaceInstanceAttributeInSameFile;

    ClassInInterfaceInSameFile;

    EnumInInterfaceInSameFile;

    interfaceStaticMethodInSameFile;
    interfaceInstanceMethodInSameFile;

    InterfaceInInterfaceInSameFile;
}

// Other unresolved references -------------------------------------------------

step unresolvedReferences() {
    unresolvedReference;
}
